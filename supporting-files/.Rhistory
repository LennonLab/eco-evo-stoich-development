axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.5,1), cex.axis = 1.25, font = 1, las = 1)
if(day.start <= 0){
abline(v = 0, lwd = 2, lty = 1, col = "black")
rect(day.start-12,-0.5,0,1.5, col = "grey94")
}
box(lwd=3)
arrows(bor.tsmeansN$B.daynumber, bor.tsmeansN$global-bor.tsSEMN$global,
bor.tsmeansN$B.daynumber, bor.tsmeansN$global+bor.tsSEMN$global,
code = 0, lwd = 3)
arrows(bor.tsmeansP$B.daynumber, bor.tsmeansP$global-bor.tsSEMP$global,
bor.tsmeansP$B.daynumber, bor.tsmeansP$global+bor.tsSEMP$global,
code = 0, lwd = 3)
points(global ~ B.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(global ~ B.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
#Phage
bn <- phage.bor[phage.bor$P.trt == "N",]
bp <- phage.bor[phage.bor$P.trt == "P",]
bor.tsmeansN <- aggregate(bn[,123:125],bn["P.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,123:125],bp["P.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,123:125],bn["P.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,123:125],bp["P.daynumber"],sem)
par(mar = c(5,6,3,1)+0.1)
plot(global ~ P.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,.5),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Infectivity",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.25,0.5), cex.axis = 1.25, font = 1, las = 1)
if(day.start <= 0){
abline(v = 0, lwd = 2, lty = 1, col = "black")
rect(day.start-12,-0.5,0,.75, col = "grey94")
}
box(lwd=3)
arrows(bor.tsmeansN$P.daynumber, bor.tsmeansN$global-bor.tsSEMN$global,
bor.tsmeansN$P.daynumber, bor.tsmeansN$global+bor.tsSEMN$global,
code = 0, lwd = 3)
arrows(bor.tsmeansP$P.daynumber, bor.tsmeansP$global-bor.tsSEMP$global,
bor.tsmeansP$P.daynumber, bor.tsmeansP$global+bor.tsSEMP$global,
code = 0, lwd = 3)
points(global ~ P.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(global ~ P.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
legend("topright",c("N-limited", "P-limited"), pch = c(21,22),
col = "black", bty='n', cex =1.5)
dev.off()
sync <- subset(sync, sync$day < 156)
sync <- na.omit(sync)
#subset data into NL and PL data sets
syncN <- subset(sync, sync$lim == "N")
syncP <- subset(sync, sync$lim == "P")
tiff(filename = "./pub-figures/FigS2-CCF.tiff",
width = 1140, height = 570, units = "px", pointsize = 13,
bg = "white", res = 100)
par(mfrow = c(1,2))
par(mar = c(5,6,3,0)+0.1)
ccfN <- ccf(syncN$Syn, syncN$Phage, lag.max = 8, type = "correlation",
ylab = "CCF", main = "N-limited",
plot = T, ylim = c(-0.5,0.5), las = 1,
cex.main = 1.5, cex.axis = 1.15, cex.lab = 1.5, font.lab = 2)
box(lwd = 3)
print(ccfN)
par(mar = c(5,4,3,2)+0.1)
ccfP <- ccf(syncP$Syn, syncP$Phage, lag.max = 8, type = "correlation",
ylab = NA, main = "P-limited",
plot = T, ylim = c(-0.5,0.5), las = 1,
cex.main = 1.5, cex.axis = 1.15, cex.lab = 1.5, font.lab = 2)
box(lwd = 3)
print(ccfP)
dev.off()
bn <- syn.bor[syn.bor$B.trt == "N",]
bp <- syn.bor[syn.bor$B.trt == "P",]
bor.tsmeansN <- aggregate(bn[,103:105],bn["B.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,103:105],bp["B.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,103:105],bn["B.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,103:105],bp["B.daynumber"],sem)
par(mfrow = c(1,2), mar = c(5,6,3,1)+0.1)
# NL Syn
plot(global ~ B.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,1),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Resistance",
main = "Resistance",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.5,1), cex.axis = 1.25, font = 1, las = 1)
if(day.start <= 0){
abline(v = 0, lwd = 2, lty = 1, col = "black")
rect(day.start-12,-0.5,0,1.5, col = "grey94")
}
box(lwd=3)
arrows(bor.tsmeansN$B.daynumber, bor.tsmeansN$global-bor.tsSEMN$global,
bor.tsmeansN$B.daynumber, bor.tsmeansN$global+bor.tsSEMN$global,
code = 0, lwd = 3)
arrows(bor.tsmeansP$B.daynumber, bor.tsmeansP$global-bor.tsSEMP$global,
bor.tsmeansP$B.daynumber, bor.tsmeansP$global+bor.tsSEMP$global,
code = 0, lwd = 3)
points(global ~ B.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(global ~ B.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
arrows(bor.tsmeansN$B.daynumber, bor.tsmeansN$global-bor.tsSEMN$global,
bor.tsmeansN$B.daynumber, bor.tsmeansN$global+bor.tsSEMN$global,
code = 0, lwd = 3)
arrows(bor.tsmeansP$B.daynumber, bor.tsmeansP$global-bor.tsSEMP$global,
bor.tsmeansP$B.daynumber, bor.tsmeansP$global+bor.tsSEMP$global,
code = 0, lwd = 3)
points(global ~ B.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(global ~ B.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
bn <- phage.bor[phage.bor$P.trt == "N",]
bp <- phage.bor[phage.bor$P.trt == "P",]
bor.tsmeansN <- aggregate(bn[,123:125],bn["P.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,123:125],bp["P.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,123:125],bn["P.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,123:125],bp["P.daynumber"],sem)
par(mar = c(5,6,3,1)+0.1)
plot(global ~ P.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,.5),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Infectivity",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.25,0.5), cex.axis = 1.25, font = 1, las = 1)
if(day.start <= 0){
abline(v = 0, lwd = 2, lty = 1, col = "black")
rect(day.start-12,-0.5,0,.75, col = "grey94")
}
box(lwd=3)
arrows(bor.tsmeansN$P.daynumber, bor.tsmeansN$global-bor.tsSEMN$global,
bor.tsmeansN$P.daynumber, bor.tsmeansN$global+bor.tsSEMN$global,
code = 0, lwd = 3)
arrows(bor.tsmeansP$P.daynumber, bor.tsmeansP$global-bor.tsSEMP$global,
bor.tsmeansP$P.daynumber, bor.tsmeansP$global+bor.tsSEMP$global,
code = 0, lwd = 3)
points(global ~ P.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(global ~ P.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
legend("topright",c("N-limited", "P-limited"), pch = c(21,22),
col = "black", bty='n', cex =1.5)
bn
phage.bor
bn <- phage.bor[phage.bor$P.lim == "N",]
bp <- phage.bor[phage.bor$P.lim == "P",]
bn
bp
bor.tsmeansN <- aggregate(bn[,123:125],bn["P.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,123:125],bp["P.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,123:125],bn["P.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,123:125],bp["P.daynumber"],sem)
plot(global ~ P.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,.5),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Infectivity",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.25,0.5), cex.axis = 1.25, font = 1, las = 1)
bor.tsmeansN
dim(bp)
bp
bor.tsmeansN <- aggregate(bn[,"global"],bn["P.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,"global"],bp["P.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,"global"],bn["P.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,"global"],bp["P.daynumber"],sem)
plot(global ~ P.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,.5),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Infectivity",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.25,0.5), cex.axis = 1.25, font = 1, las = 1)
bor.tsmeansN
tiff(filename = "./pub-figures/FigS3-ResHR.tiff",
width = 1140, height = 570, units = "px", pointsize = 13,
bg = "white", res = 100)
day.start = -6
bn <- syn.bor[syn.bor$B.trt == "N",]
bp <- syn.bor[syn.bor$B.trt == "P",]
bor.tsmeansN <- aggregate(bn[,103:105],bn["B.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,103:105],bp["B.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,103:105],bn["B.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,103:105],bp["B.daynumber"],sem)
par(mfrow = c(1,2), mar = c(5,6,3,1)+0.1)
# NL Syn
plot(global ~ B.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,1),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Resistance",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.5,1), cex.axis = 1.25, font = 1, las = 1)
if(day.start <= 0){
abline(v = 0, lwd = 2, lty = 1, col = "black")
rect(day.start-12,-0.5,0,1.5, col = "grey94")
}
box(lwd=3)
arrows(bor.tsmeansN$B.daynumber, bor.tsmeansN$global-bor.tsSEMN$global,
bor.tsmeansN$B.daynumber, bor.tsmeansN$global+bor.tsSEMN$global,
code = 0, lwd = 3)
arrows(bor.tsmeansP$B.daynumber, bor.tsmeansP$global-bor.tsSEMP$global,
bor.tsmeansP$B.daynumber, bor.tsmeansP$global+bor.tsSEMP$global,
code = 0, lwd = 3)
points(global ~ B.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(global ~ B.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
#Phage
bn <- phage.bor[phage.bor$P.lim == "N",]
bp <- phage.bor[phage.bor$P.lim == "P",]
bor.tsmeansN <- aggregate(bn[,"global"],bn["P.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,"global"],bp["P.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,"global"],bn["P.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,"global"],bp["P.daynumber"],sem)
par(mar = c(5,6,3,1)+0.1)
plot(x ~ P.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,.5),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Infectivity",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.25,0.5), cex.axis = 1.25, font = 1, las = 1)
if(day.start <= 0){
abline(v = 0, lwd = 2, lty = 1, col = "black")
rect(day.start-12,-0.5,0,.75, col = "grey94")
}
box(lwd=3)
arrows(bor.tsmeansN$P.daynumber, bor.tsmeansN$x-bor.tsSEMN$x,
bor.tsmeansN$P.daynumber, bor.tsmeansN$x+bor.tsSEMN$x,
code = 0, lwd = 3)
arrows(bor.tsmeansP$P.daynumber, bor.tsmeansP$x-bor.tsSEMP$x,
bor.tsmeansP$P.daynumber, bor.tsmeansP$x+bor.tsSEMP$x,
code = 0, lwd = 3)
points(x ~ P.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(x ~ P.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
legend("topright",c("N-limited", "P-limited"), pch = c(21,22),
col = "black", bty='n', cex =1.5)
dev.off()
tiff(filename = "./pub-figures/FigS3-ResHR.tiff",
width = 1140, height = 570, units = "px", pointsize = 13,
bg = "white", res = 100)
day.start = -6
bn <- syn.bor[syn.bor$B.trt == "N",]
bp <- syn.bor[syn.bor$B.trt == "P",]
bor.tsmeansN <- aggregate(bn[,103:105],bn["B.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,103:105],bp["B.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,103:105],bn["B.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,103:105],bp["B.daynumber"],sem)
par(mfrow = c(1,2), mar = c(5,6,3,1)+0.1)
# NL Syn
plot(global ~ B.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,1),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Resistance",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.5,1), cex.axis = 1.25, font = 1, las = 1)
if(day.start <= 0){
abline(v = 0, lwd = 2, lty = 1, col = "black")
rect(day.start-12,-0.5,0,1.5, col = "grey94")
}
box(lwd=3)
arrows(bor.tsmeansN$B.daynumber, bor.tsmeansN$global-bor.tsSEMN$global,
bor.tsmeansN$B.daynumber, bor.tsmeansN$global+bor.tsSEMN$global,
code = 0, lwd = 3)
arrows(bor.tsmeansP$B.daynumber, bor.tsmeansP$global-bor.tsSEMP$global,
bor.tsmeansP$B.daynumber, bor.tsmeansP$global+bor.tsSEMP$global,
code = 0, lwd = 3)
points(global ~ B.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(global ~ B.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
#Phage
bn <- phage.bor[phage.bor$P.lim == "N",]
bp <- phage.bor[phage.bor$P.lim == "P",]
bor.tsmeansN <- aggregate(bn[,"global"],bn["P.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,"global"],bp["P.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,"global"],bn["P.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,"global"],bp["P.daynumber"],sem)
par(mar = c(6,6,3,1)+0.1)
plot(x ~ P.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,.5),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Infectivity",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.25,0.5), cex.axis = 1.25, font = 1, las = 1)
if(day.start <= 0){
abline(v = 0, lwd = 2, lty = 1, col = "black")
rect(day.start-12,-0.5,0,.75, col = "grey94")
}
box(lwd=3)
arrows(bor.tsmeansN$P.daynumber, bor.tsmeansN$x-bor.tsSEMN$x,
bor.tsmeansN$P.daynumber, bor.tsmeansN$x+bor.tsSEMN$x,
code = 0, lwd = 3)
arrows(bor.tsmeansP$P.daynumber, bor.tsmeansP$x-bor.tsSEMP$x,
bor.tsmeansP$P.daynumber, bor.tsmeansP$x+bor.tsSEMP$x,
code = 0, lwd = 3)
points(x ~ P.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(x ~ P.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
legend("bottomright",c("N-limited", "P-limited"), pch = c(21,22),
col = "black", bty='n', cex =1.5)
dev.off()
tiff(filename = "./pub-figures/FigS3-ResHR.tiff",
width = 1140, height = 570, units = "px", pointsize = 13,
bg = "white", res = 100)
day.start = -6
bn <- syn.bor[syn.bor$B.trt == "N",]
bp <- syn.bor[syn.bor$B.trt == "P",]
bor.tsmeansN <- aggregate(bn[,103:105],bn["B.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,103:105],bp["B.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,103:105],bn["B.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,103:105],bp["B.daynumber"],sem)
par(mfrow = c(1,2), mar = c(5,6,3,1)+0.1)
# NL Syn
plot(global ~ B.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,1),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Resistance",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.5,1), cex.axis = 1.25, font = 1, las = 1)
if(day.start <= 0){
abline(v = 0, lwd = 2, lty = 1, col = "black")
rect(day.start-12,-0.5,0,1.5, col = "grey94")
}
box(lwd=3)
arrows(bor.tsmeansN$B.daynumber, bor.tsmeansN$global-bor.tsSEMN$global,
bor.tsmeansN$B.daynumber, bor.tsmeansN$global+bor.tsSEMN$global,
code = 0, lwd = 3)
arrows(bor.tsmeansP$B.daynumber, bor.tsmeansP$global-bor.tsSEMP$global,
bor.tsmeansP$B.daynumber, bor.tsmeansP$global+bor.tsSEMP$global,
code = 0, lwd = 3)
points(global ~ B.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(global ~ B.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
#Phage
bn <- phage.bor[phage.bor$P.lim == "N",]
bp <- phage.bor[phage.bor$P.lim == "P",]
bor.tsmeansN <- aggregate(bn[,"global"],bn["P.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,"global"],bp["P.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,"global"],bn["P.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,"global"],bp["P.daynumber"],sem)
par(mar = c(5,6,3,1)+0.1)
plot(x ~ P.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,.5),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Infectivity",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.25,0.5), cex.axis = 1.25, font = 1, las = 1)
if(day.start <= 0){
abline(v = 0, lwd = 2, lty = 1, col = "black")
rect(day.start-12,-0.5,0,.75, col = "grey94")
}
box(lwd=3)
arrows(bor.tsmeansN$P.daynumber, bor.tsmeansN$x-bor.tsSEMN$x,
bor.tsmeansN$P.daynumber, bor.tsmeansN$x+bor.tsSEMN$x,
code = 0, lwd = 3)
arrows(bor.tsmeansP$P.daynumber, bor.tsmeansP$x-bor.tsSEMP$x,
bor.tsmeansP$P.daynumber, bor.tsmeansP$x+bor.tsSEMP$x,
code = 0, lwd = 3)
points(x ~ P.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(x ~ P.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
legend("bottomright",c("N-limited", "P-limited"), pch = c(21,22),
col = "black", bty='n', cex =1.5)
dev.off()
tiff(filename = "./pub-figures/FigS4-ResHR.tiff",
width = 1140, height = 570, units = "px", pointsize = 13,
bg = "white", res = 100)
day.start = -6
bn <- syn.bor[syn.bor$B.trt == "N",]
bp <- syn.bor[syn.bor$B.trt == "P",]
bor.tsmeansN <- aggregate(bn[,103:105],bn["B.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,103:105],bp["B.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,103:105],bn["B.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,103:105],bp["B.daynumber"],sem)
par(mfrow = c(1,2), mar = c(5,6,3,1)+0.1)
# NL Syn
plot(global ~ B.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,1),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Resistance",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.5,1), cex.axis = 1.25, font = 1, las = 1)
if(day.start <= 0){
abline(v = 0, lwd = 2, lty = 1, col = "black")
rect(day.start-12,-0.5,0,1.5, col = "grey94")
}
box(lwd=3)
arrows(bor.tsmeansN$B.daynumber, bor.tsmeansN$global-bor.tsSEMN$global,
bor.tsmeansN$B.daynumber, bor.tsmeansN$global+bor.tsSEMN$global,
code = 0, lwd = 3)
arrows(bor.tsmeansP$B.daynumber, bor.tsmeansP$global-bor.tsSEMP$global,
bor.tsmeansP$B.daynumber, bor.tsmeansP$global+bor.tsSEMP$global,
code = 0, lwd = 3)
points(global ~ B.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(global ~ B.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
#Phage
bn <- phage.bor[phage.bor$P.lim == "N",]
bp <- phage.bor[phage.bor$P.lim == "P",]
bor.tsmeansN <- aggregate(bn[,"global"],bn["P.daynumber"],function(x) mean(x))
bor.tsmeansP <- aggregate(bp[,"global"],bp["P.daynumber"],function(x) mean(x))
bor.tsSEMN <- aggregate(bn[,"global"],bn["P.daynumber"],sem)
bor.tsSEMP <- aggregate(bp[,"global"],bp["P.daynumber"],sem)
par(mar = c(5,6,3,1)+0.1)
plot(x ~ P.daynumber, data = bor.tsmeansN,
xlim = c(-10,170),ylim = c(0,.5),
xaxt = 'n', yaxt = 'n',
xlab = "Time (d)",ylab = "Infectivity",
type = "n", font.lab = 2,
cex = 2, cex.lab = 1.5)
axis(1, c(0,40,80,120,160),cex.axis = 1.25, font = 1)
axis(2, c(0,0.25,0.5), cex.axis = 1.25, font = 1, las = 1)
if(day.start <= 0){
abline(v = 0, lwd = 2, lty = 1, col = "black")
rect(day.start-12,-0.5,0,.75, col = "grey94")
}
box(lwd=3)
arrows(bor.tsmeansN$P.daynumber, bor.tsmeansN$x-bor.tsSEMN$x,
bor.tsmeansN$P.daynumber, bor.tsmeansN$x+bor.tsSEMN$x,
code = 0, lwd = 3)
arrows(bor.tsmeansP$P.daynumber, bor.tsmeansP$x-bor.tsSEMP$x,
bor.tsmeansP$P.daynumber, bor.tsmeansP$x+bor.tsSEMP$x,
code = 0, lwd = 3)
points(x ~ P.daynumber, data = bor.tsmeansN,
type = "p", pch = 21,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
points(x ~ P.daynumber, data = bor.tsmeansP,
type = "p", pch = 22,
col = "black", bg = "white",
lty = 1, lwd = 2, cex = 3)
legend("bottomright",c("N-limited", "P-limited"), pch = c(21,22),
col = "black", bty='n', cex =1.5)
dev.off()
dev.off()
