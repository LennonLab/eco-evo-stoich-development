l <- r + length(m3[,1])
cid.list <- append(cid.list,rep(as.character(i),length(m3[,1])))
b.cid.list <- append(b.cid.list,rep(as.character(unique(res4b$B.cID)),length(m3[,1])))
phage.time <- append(phage.time,m3$P.daynumber)
bac.time <- append(bac.time,m3$B.daynumber)
inf.prob <- append(inf.prob, m3$value)
}
bor.cstat.Ncontrol <- data.frame(b.cid.list,cid.list,phage.time,bac.time,inf.prob)
#Initialize data storage
lim.list <- c(); cid.list <- c(); phage.time <- c(); bac.time <- c(); inf.prob <- c();b.cid.list <- c()
r = 1
l = 0
#Remove the ancestral phage data
res4 <- subset(res4,P.cID !="RIM8-1")
res4 <- subset(res4,B.cID !="WH7803")
res4 <- subset(res4,B.cID !="WH8101")
cID = c("N2","N3","N5")
for(i in cID){
r <- r + l
res4b <- subset(res4,(P.cID == i | is.na(P.cID)) & (B.lim == "N" & B.trt == "T" | is.na(B.cID)))
# pull out the relevant columns after subsetting as needed.
res5 <- res4b[,c("P.daynumber","B.daynumber","infectivity")]
# prevent factors; coerce to numeric
res5 <- as.data.frame(apply(res5,2,function(x) as.numeric(as.character(x))))
m2 <- melt(res5,id=c("P.daynumber","B.daynumber"))
c2 <- cast(m2,P.daynumber~B.daynumber,fun.aggregate = infect.prop)
c3 <- c2
rownames(c2) <- c2$P.daynumber
c2 <- c2[,-1]
write.csv(c2, file = paste("./output/20150710_infmatrix",i,"Ncoevo",".csv",sep = ""), row.names = T)
m3 <- melt(c3,id=c("P.daynumber","B.daynumber"))
l <- r + length(m3[,1])
cid.list <- append(cid.list,rep(as.character(i),length(m3[,1])))
b.cid.list <- append(b.cid.list,rep(as.character(unique(res4b$B.cID)),length(m3[,1])))
phage.time <- append(phage.time,m3$P.daynumber)
bac.time <- append(bac.time,m3$B.daynumber)
inf.prob <- append(inf.prob, m3$value)
}
bor.cstat.Ncoevo <- data.frame(b.cid.list, cid.list,phage.time,bac.time,inf.prob)
#Initialize data storage
lim.list <- c(); cid.list <- c(); phage.time <- c(); bac.time <- c(); inf.prob <- c();b.cid.list <- c()
r = 1
l = 0
#Remove the ancestral phage data
res4 <- subset(res4,P.cID !="RIM8-1")
res4 <- subset(res4,B.cID !="WH7803")
res4 <- subset(res4,B.cID !="WH8101")
cID = c("P2","P4","P5")
for(i in cID){
r <- r + l
res4b <- subset(res4,(P.cID == i | is.na(P.cID)) & (B.lim == "P" & B.trt == "C" | is.na(B.cID)))
# pull out the relevant columns after subsetting as needed.
res5 <- res4b[,c("P.daynumber","B.daynumber","infectivity")]
# prevent factors; coerce to numeric
res5 <- as.data.frame(apply(res5,2,function(x) as.numeric(as.character(x))))
m2 <- melt(res5,id=c("P.daynumber","B.daynumber"))
c2 <- cast(m2,P.daynumber~B.daynumber,fun.aggregate = infect.prop)
c3 <- c2
rownames(c2) <- c2$P.daynumber
c2 <- c2[,-1]
write.csv(c2, file = paste("./output/20150710_infmatrix",i,"Pcontrol",".csv",sep = ""), row.names = T)
m3 <- melt(c3,id=c("P.daynumber","B.daynumber"))
l <- r + length(m3[,1])
cid.list <- append(cid.list,rep(as.character(i),length(m3[,1])))
b.cid.list <- append(b.cid.list,rep(as.character(unique(res4b$B.cID)),length(m3[,1])))
phage.time <- append(phage.time,m3$P.daynumber)
bac.time <- append(bac.time,m3$B.daynumber)
inf.prob <- append(inf.prob, m3$value)
}
bor.cstat.Pcontrol <- data.frame(b.cid.list, cid.list,phage.time,bac.time,inf.prob)
#Initialize data storage
lim.list <- c(); cid.list <- c(); phage.time <- c(); bac.time <- c(); inf.prob <- c();b.cid.list <- c()
r = 1
l = 0
#Remove the ancestral phage data
res4 <- subset(res4,P.cID !="RIM8-1")
res4 <- subset(res4,B.cID !="WH7803")
res4 <- subset(res4,B.cID !="WH8101")
cID = c("P2","P4","P5")
for(i in cID){
r <- r + l
res4b <- subset(res4,(P.cID == i | is.na(P.cID)) & (B.lim == "P" & B.trt == "T" | is.na(B.cID)))
# pull out the relevant columns after subsetting as needed.
res5 <- res4b[,c("P.daynumber","B.daynumber","infectivity")]
# prevent factors; coerce to numeric
res5 <- as.data.frame(apply(res5,2,function(x) as.numeric(as.character(x))))
m2 <- melt(res5,id=c("P.daynumber","B.daynumber"))
c2 <- cast(m2,P.daynumber~B.daynumber,fun.aggregate = infect.prop)
c3 <- c2
rownames(c2) <- c2$P.daynumber
c2 <- c2[,-1]
write.csv(c2, file = paste("./output/20150710_infmatrix",i,"Pcoevo",".csv",sep = ""), row.names = T)
m3 <- melt(c3,id=c("P.daynumber","B.daynumber"))
l <- r + length(m3[,1])
cid.list <- append(cid.list,rep(as.character(i),length(m3[,1])))
b.cid.list <- append(b.cid.list,rep(as.character(unique(res4b$B.cID)),length(m3[,1])))
phage.time <- append(phage.time,m3$P.daynumber)
bac.time <- append(bac.time,m3$B.daynumber)
inf.prob <- append(inf.prob, m3$value)
}
bor.cstat.Pcoevo <- data.frame(b.cid.list, cid.list,phage.time,bac.time,inf.prob)
#bor.cstat.Ncontrol
bor.cstat.Ncontrol$trt <- rep("C", length(bor.cstat.Ncontrol[,1]))
bor.cstat.Ncontrol$lim <- rep("N", length(bor.cstat.Ncontrol[,1]))
#bor.cstat.Ncoevo
bor.cstat.Ncoevo$trt  <- rep("T", length(bor.cstat.Ncoevo[,1]))
bor.cstat.Ncoevo$lim <- rep("N", length(bor.cstat.Ncoevo[,1]))
#bor.cstat.Pcontrol
bor.cstat.Pcontrol$trt  <- rep("C", length(bor.cstat.Pcontrol[,1]))
bor.cstat.Pcontrol$lim <- rep("P", length(bor.cstat.Pcontrol[,1]))
#bor.cstat.Pcoevo
bor.cstat.Pcoevo$trt <- rep("T", length(bor.cstat.Pcoevo[,1]))
bor.cstat.Pcoevo$lim <- rep("P", length(bor.cstat.Pcoevo[,1]))
bor.cstat <- rbind(bor.cstat.Ncontrol, bor.cstat.Ncoevo, bor.cstat.Pcontrol, bor.cstat.Pcoevo)
colnames(bor.cstat) <- c("BcID","cID","phage.time","bac.time","inf.prob","trt","lim")
bor.cstat$ptime.adj <- bor.cstat$phage.time
bor.cstat$btime.adj <- bor.cstat$bac.time
bor.cstat$btime.adj[bor.cstat$btime.adj == -6] <- 1
bor.cstat$btime.adj[bor.cstat$btime.adj == 9] <- 2
bor.cstat$btime.adj[bor.cstat$btime.adj == 23] <- 3
bor.cstat$btime.adj[bor.cstat$btime.adj == 72] <- 4
bor.cstat$btime.adj[bor.cstat$btime.adj == 100] <- 5
bor.cstat$btime.adj[bor.cstat$btime.adj == 129] <- 6
bor.cstat$btime.adj[bor.cstat$btime.adj == 166] <- 7
bor.cstat$ptime.adj[bor.cstat$ptime.adj == 9] <- 2
bor.cstat$ptime.adj[bor.cstat$ptime.adj == 23] <- 3
bor.cstat$ptime.adj[bor.cstat$ptime.adj == 72] <- 4
bor.cstat$ptime.adj[bor.cstat$ptime.adj == 129] <- 6
bor.cstat$ptime.adj[bor.cstat$ptime.adj == 166] <- 7
bor.cstat$time.shift <- bor.cstat$phage.time-bor.cstat$bac.time
bor.cstat$bac.time.fac <- as.factor(bor.cstat$bac.time)
bor.cstat$p.time.shift <- bor.cstat$btime.adj-bor.cstat$ptime.adj
bor.cstat$phage.time.fac <- as.factor(bor.cstat$phage.time)
# Time shift by time point
p <- ggplot(bor.cstat, aes(x = time.shift, y = inf.prob, col = bac.time.fac)) +
geom_point()+
#  geom_point(bor.cstat[bor.cstat$time.shift == 0,], aes(x = time.shift, y = inf.prob),
#             col = "black",size = 1.25) +
stat_summary(fun.y = mean,geom="line")+
facet_grid(trt~lim)+
xlab("Time Shift (days) relative to host") +
ylab("Interaction Strength") +
theme_bw()+
theme(#legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)))
print(p)
p1 <- ggplot(bor.cstat, aes(x = time.shift, y = inf.prob)) +
geom_point(aes(col = bac.time.fac)) +
#stat_summary(fun.y = mean, geom="line")+
facet_grid(trt~lim)+
stat_smooth(geom = "smooth", method = "loess")
p2 <- ggplot(bor.cstat, aes(x = p.time.shift, y = inf.prob, col = phage.time.fac)) +
geom_point() + stat_summary(fun.y = mean, geom="line")+
facet_grid(trt~lim)
p3 <- ggplot(bor.cstat, aes(x = p.time.shift, y = inf.prob)) +
geom_point(aes(col = phage.time.fac)) + stat_summary(fun.y = mean, geom="line")+
facet_grid(trt~lim)
#Run RMANOVA with different models
model.ar <- lme(inf.prob ~ trt * lim * time.shift, random = ~1 | BcID,
correlation = corAR1(form = ~1 ),
data = bor.cstat)
model.arma <- lme(inf.prob ~ trt* lim * time.shift,random = ~1 | BcID,
correlation = corARMA(form = ~1, p = 1, q = 1),
data = bor.cstat)
model.arma1 <- lme(inf.prob ~ trt* lim * time.shift, random = ~1 | BcID,
correlation = corARMA(form = ~1, p = 1, q = 2),
data = bor.cstat)
#Select which model fits the data better
#anova(model.ar,model.arma, model.arma1)
pander(summary(model.arma1))
?ggsave
ggsave(p, "./supporting-files/time_shift.tiff", device = "tiff",
scale = 1, width = 6, height = 6, units = "in", dpi = 300)
ggsave(p, "./supporting-files/time_shift.tiff", device = "tiff",
scale = 1, width = 6, height = 6, units = in, dpi = 300)
ggsave(p, "./supporting-files/time_shift.tif", device = "tiff",
scale = 1, width = 6, height = 6, units = "in", dpi = 300)
ggsave("./supporting-files/time_shift.tif", p, device = "tiff",
scale = 1, width = 6, height = 6, units = "in", dpi = 300)
ggsave("./supporting-files/time_shift.tif", p, device = "tiff",
scale = 1, width = 6, height = 4, units = "in", dpi = 300)
b.type.func <- function(x,y){
if(y < x){
type <- "P"
} else if(y == x){
type <- "C"
} else {
type <- "F"
}
return(type)
}
bor.cstat$b.type <- mapply(b.type.func,bor.cstat$bac.time,bor.cstat$phage.time)
bor.cstat$p.type <- mapply(b.type.func,bor.cstat$phage.time, bor.cstat$bac.time)
# cyano time
p4 <- ggplot(bor.cstat, aes(x = as.factor(bac.time), inf.prob)) +
geom_point(aes(shape = as.factor(phage.time), color = BcID)) +
stat_summary(fun.data = "mean_cl_boot", col = "black", size = 1.25) +
facet_grid(trt~lim) +
theme_bw()+
theme(legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank()) +
xlab("Synechococcus Isolation Time (d)") +
ylab("Interaction Strength")
print(p4)
p4 <- ggplot(bor.cstat, aes(x = as.factor(bac.time), inf.prob)) +
geom_point(aes(shape = as.factor(phage.time), color = BcID)) +
stat_summary(fun.data = "mean_cl_boot", col = "black", size = 1.25) +
facet_grid(trt~lim) +
theme_bw()+
theme(#legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank()) +
xlab("Synechococcus Isolation Time (d)") +
ylab("Interaction Strength")
print(p4)
p4 <- ggplot(bor.cstat, aes(x = as.factor(bac.time), inf.prob)) +
geom_point(aes(shape = as.factor(phage.time), color = BcID), name = c("Phage Isolation\n Timepoint","Chemostat ID")) +
stat_summary(fun.data = "mean_cl_boot", col = "black", size = 1.25) +
facet_grid(trt~lim) +
theme_bw()+
theme(#legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank()) +
xlab("Synechococcus Isolation Time (d)") +
ylab("Interaction Strength")
print(p4)
p4 <- ggplot(bor.cstat, aes(x = as.factor(bac.time), inf.prob)) +
geom_point(aes(shape = as.factor(phage.time), color = BcID), title = c("Phage Isolation\n Timepoint","Chemostat ID")) +
stat_summary(fun.data = "mean_cl_boot", col = "black", size = 1.25) +
facet_grid(trt~lim) +
theme_bw()+
theme(#legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank()) +
xlab("Synechococcus Isolation Time (d)") +
ylab("Interaction Strength")
print(p4)
p4 <- ggplot(bor.cstat, aes(x = as.factor(bac.time), inf.prob)) +
geom_point(aes(shape = as.factor(phage.time), color = BcID)) +
stat_summary(fun.data = "mean_cl_boot", col = "black", size = 1.25) +
facet_grid(trt~lim) +
theme_bw()+
theme(#legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank()) +
xlab("Synechococcus Isolation Time (d)") +
ylab("Interaction Strength")
print(p4)
ggsave("./supporting-files/cyano_time.tif", p4, device = "tiff",
scale = 1, width = 6, height = 4, units = "in", dpi = 300)
p4 <- ggplot(bor.cstat, aes(x = as.factor(bac.time), inf.prob)) +
geom_point(aes(shape = as.factor(phage.time), color = BcID)) +
stat_summary(fun.data = "mean_cl_boot", col = "black", size = 1) +
facet_grid(trt~lim) +
theme_bw()+
theme(legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank()) +
xlab("Synechococcus Isolation Time (d)") +
ylab("Interaction Strength")
print(p4)
ggsave("./supporting-files/cyano_time.tif", p4, device = "tiff",
scale = 1, width = 6, height = 4, units = "in", dpi = 300)
p4 <- ggplot(bor.cstat, aes(x = as.factor(bac.time), inf.prob)) +
geom_point(aes(shape = as.factor(phage.time), color = BcID)) +
stat_summary(fun.data = "mean_cl_boot", col = "black", size = 0.75) +
facet_grid(trt~lim) +
theme_bw()+
theme(legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank()) +
xlab("Synechococcus Isolation Time (d)") +
ylab("Interaction Strength")
print(p4)
ggsave("./supporting-files/cyano_time.tif", p4, device = "tiff",
scale = 1, width = 6, height = 4, units = "in", dpi = 300)
p5 <- ggplot(bor.cstat, aes(x = as.factor(phage.time), inf.prob)) +
geom_point(aes(shape = as.factor(phage.time), color = BcID)) +
stat_summary(fun.data = "mean_cl_boot", col = "black", size = 0.75) +
facet_grid(trt~lim) +
theme_bw()+
theme(legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank()) +
xlab("Phage Isolation Time (d)") +
ylab("Interaction Strength")
ggsave("./supporting-files/phage_time.tif", p5, device = "tiff",
scale = 1, width = 6, height = 4, units = "in", dpi = 300)
model.arma1 <- lme(inf.prob ~ trt* lim * bac.time, random = ~1 | BcID,
correlation = corARMA(form = ~1, p = 1, q = 2),
data = bor.cstat)
summary(model.arma1)
model.arma1 <- lme(inf.prob ~ trt* lim * phage.time, random = ~1 | BcID,
correlation = corARMA(form = ~1, p = 1, q = 2),
data = bor.cstat)
summary(model.arma1)
p5 <- ggplot(bor.cstat, aes(x = as.factor(phage.time), inf.prob)) +
geom_point(aes(shape = as.factor(phage.time), color = BcID)) +
stat_summary(fun.data = "mean_cl_boot", col = "black", size = 0.75) +
facet_grid(trt~lim) +
theme_bw()+
theme(legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank()) +
xlab("Phage Isolation Time (d)") +
ylab("Interaction Strength")
print(p5)
model.arma1 <- lme(inf.prob ~ trt* lim * time.shift, random = ~1 | BcID,
correlation = corARMA(form = ~1, p = 1, q = 2),
data = bor.cstat)
summary(model.arma1)
p <- ggplot(bor.cstat, aes(x = time.shift, y = inf.prob, col = bac.time.fac)) +
#geom_point()+
#  geom_point(bor.cstat[bor.cstat$time.shift == 0,], aes(x = time.shift, y = inf.prob),
#             col = "black",size = 1.25) +
stat_summary(fun.y = mean,geom="line")+
facet_grid(trt~lim)+
xlab("Time Shift (days) relative to host") +
ylab("Interaction Strength") +
theme_bw()+
theme(#legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank())
print(p)
?geom_label
p <- ggplot(bor.cstat, aes(x = time.shift, y = inf.prob, col = bac.time.fac)) +
#geom_point()+
#  geom_point(bor.cstat[bor.cstat$time.shift == 0,], aes(x = time.shift, y = inf.prob),
#             col = "black",size = 1.25) +
geom_text(label.size = 0.25) +
stat_summary(fun.y = mean,geom="line")+
facet_grid(trt~lim)+
xlab("Time Shift (days) relative to host") +
ylab("Interaction Strength") +
theme_bw()+
theme(legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank())
print(p)
p <- ggplot(bor.cstat, aes(x = time.shift, y = inf.prob, col = bac.time.fac)) +
#geom_point()+
#  geom_point(bor.cstat[bor.cstat$time.shift == 0,], aes(x = time.shift, y = inf.prob),
#             col = "black",size = 1.25) +
geom_text(label = bac.time.fac,label.size = 0.25) +
stat_summary(fun.y = mean,geom="line")+
facet_grid(trt~lim)+
xlab("Time Shift (days) relative to host") +
ylab("Interaction Strength") +
theme_bw()+
theme(legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank())
print(p)
p <- ggplot(bor.cstat, aes(x = time.shift, y = inf.prob, col = bac.time.fac)) +
#geom_point()+
#  geom_point(bor.cstat[bor.cstat$time.shift == 0,], aes(x = time.shift, y = inf.prob),
#             col = "black",size = 1.25) +
geom_text(label = bor.cstat$bac.time.fac,label.size = 0.25) +
stat_summary(fun.y = mean,geom="line")+
facet_grid(trt~lim)+
xlab("Time Shift (days) relative to host") +
ylab("Interaction Strength") +
theme_bw()+
theme(legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank())
print(p)
?annotate
p <- ggplot(bor.cstat, aes(x = time.shift, y = inf.prob, col = bac.time.fac)) +
#geom_point()+
#  geom_point(bor.cstat[bor.cstat$time.shift == 0,], aes(x = time.shift, y = inf.prob),
#             col = "black",size = 1.25) +
#annotate("text", x = label = bac.time.fac) +
stat_summary(fun.y = mean,geom="line")+
facet_grid(trt~lim)+
xlab("Time Shift (days) relative to host") +
ylab("Interaction Strength") +
theme_bw()+
theme(legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank())
print(p)
ggsave("./supporting-files/time_shift.tif", p, device = "tiff",
scale = 1, width = 6, height = 4, units = "in", dpi = 300)
levels(bor.cstat$lim)
str(bor.cstat)
levels(bor.cstat$lim) <- c("N-limited","P-limited")
str(bor.cstat)
p <- ggplot(bor.cstat, aes(x = time.shift, y = inf.prob, col = bac.time.fac)) +
#geom_point()+
#  geom_point(bor.cstat[bor.cstat$time.shift == 0,], aes(x = time.shift, y = inf.prob),
#             col = "black",size = 1.25) +
#annotate("text", x = label = bac.time.fac) +
stat_summary(fun.y = mean,geom="line")+
facet_grid(trt~lim)+
xlab("Time Shift (days) relative to host") +
ylab("Interaction Strength") +
theme_bw()+
theme(legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank())
print(p)
facet_names <- list(
'N'="N-limited",
'P'="P-limited",
'C'="Non-phage amended control",
'T'="Phage amended"
)
facet_labeller <- function(variable,value){
return(facet_names[value])
}
p <- ggplot(bor.cstat, aes(x = time.shift, y = inf.prob, col = bac.time.fac)) +
#geom_point()+
#  geom_point(bor.cstat[bor.cstat$time.shift == 0,], aes(x = time.shift, y = inf.prob),
#             col = "black",size = 1.25) +
#annotate("text", x = label = bac.time.fac) +
stat_summary(fun.y = mean,geom="line")+
facet_grid(trt~lim, labeller=facet_labeller)+
xlab("Time Shift (days) relative to host") +
ylab("Interaction Strength") +
theme_bw()+
theme(legend.position='none',
axis.text.x  = element_text(size=10),
axis.text.y  = element_text(size=10),
axis.title.x = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
axis.title.y = element_text(colour="black", size=12,
margin = margin(20,20,10,10)),
panel.grid = element_blank(),
strip.background = element_rect(fill="white"))
print(p)
